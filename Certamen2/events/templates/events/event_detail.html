{% extends "events/base.html" %}
{% block title %}{{ event.title }}{% endblock %}
{% block content %}
<article class="event-detail">
  <header>
    <h1>{{ event.title }}</h1>
    <p class="muted">{{ event.start_datetime|date:"d/m/Y H:i" }} · {{ event.location }}</p>
  </header>
  {% if event.image_url %}
    <img class="hero" src="{{ event.image_url }}" alt="{{ event.title }}">
  {% endif %}
  <section class="description">
    <p>{{ event.description|linebreaks }}</p>
  </section>
  <aside class="cta">
    <p><strong>Valor:</strong> ${{ event.price }}</p>
    <p><strong>Plazas disponibles:</strong> {{ event.seats_available }}</p>
    {% if user.is_authenticated %}
      {% if already_registered %}
        <div class="flash info">Ya estás inscrito en este evento.</div>
      {% elif event.seats_available <= 0 %}
        <button disabled>Sin plazas</button>
      {% else %}
        <form method="post" action="{% url 'events:register_to_event' event.pk %}">
          {% csrf_token %}
          <button>Inscribirme</button>
        </form>
      {% endif %}
    {% else %}
      <a href="{% url 'login' %}?next={% url 'events:event_detail' event.pk %}">Ingresar para inscribirme</a>
    {% endif %}
  </aside>
</article>
{% endblock %}